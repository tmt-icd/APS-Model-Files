subsystem=APS
component=ICS.PIT.Sequencer
description=""""""
receive=[
    {
        name=setup
        description="""Sets up the PIT Loop.  The filter is selected and all other values saved in global sequencer script variables to be used to take exposures or during loop execution computations"""
        completionType=longRunning
		requiredArgs=["pitFilter", "pitPupilMask",  "pitToPshPrRotationOffset", "pitToPshPrScaleOffset", "pitToPshPrXTranslationOffset", "pitToPshPrYTranslationOffset"]
		args=[
            {
				name=pitFilter
				description="""The name of the filter to position into the beam"""
				enum= [F890N, F891N, F850M, F750W, F810N, F630N, F865N]
			}
            {
				name=pitPupilMask
				description="""The name of the pupilMask to position into the beam"""
				enum= [PH-2-0, SH-0, SH-2, SH-5, Clear]
			}
            {
                name=pitToPshPrRotationOffset
                description="""PIT to PSH Pupil Registration offset (rotation).  Originating from most recent Pupil Registration Calibration Procedure"""
                type=float
                units=degree
            }
            {
                name=pitToPshPrScaleOffset
                description="""PIT to PSH Pupil Registration offset (scale).  Originating from most recent Pupil Registration Calibration Procedure"""
                type=float
            }
            {
                name=pitToPshPrXTranslationOffset
                description="""PIT to PSH Pupil Registration offset (x-translation).  Originating from most recent Pupil Registration Calibration Procedure"""
                type=float
                units=millimeter
            }
            {
                name=pitToPshPrYTranslationOffset
                description="""PIT to PSH Pupil Registration offset (y-translation).  Originating from most recent Pupil Registration Calibration Procedure"""
                type=float
                units=millimeter
            }
            {
                name=pshPointingOffsetsCalibrationImageCenterX
                description="""PSH image center in pixel columns.  Originating from most recent Camera Pointing Offsets Calibration Procedure"""
                type=float
                units=pix
            }
            {
                name=pshPointingOffsetsCalibrationImageCenterY
                description="""PSH image center in pixel rows.  Originating from most recent Camera Pointing Offsets Calibration Procedure"""
                type=float
                units=pix
            }
            {
                name=pitPointingOffsetsCalibrationImageCenterX
                description="""PIT image center in pixel columns.  Originating from most recent Camera Pointing Offsets Calibration Procedure"""
                type=float
                units=pix
            }
            {
                name=pitPointingOffsetsCalibrationImageCenterY
                description="""PIT image center in pixel rows.  Originating from most recent Camera Pointing Offsets Calibration Procedure"""
                type=float
                units=pix
            }
            {
                name=aptPointingOffsetsCalibrationCentroidX
                description="""APT centroid in pixel columns.  Originating from most recent Camera Pointing Offsets Calibration Procedure"""
                type=float
                units=pix
            }
            {
                name=aptPointingOffsetsCalibrationCentroidY
                description="""APT centroid in pixel rows.  Originating from most recent Camera Pointing Offsets Calibration Procedure"""
                type=float
                units=pix
            }


        ]

    }
    {
        name=startPitLoop
        description="""Starts the PIT Loop"""
        completionType=longRunning
		requiredArgs=["integrationTime", "gainMode"]
		args=[
           {
				name=integrationTime
				description="""Detector integration time"""
                type=float 
                units=second
			}
 			{
				name=gainMode
				description="""The APT Detector gain mode"""
                enum=["12-BIT", "16-BIT"] 
			}
        ]
    }
    {
        name=stopPitLoop
        description="""Stops the PIT Loop"""
    }
]
send=[

    # Internal ICS component commands
	{
		name=setMode
		subsystem=APS
		component=ICS.FOC.KMirror
	}
	{
		name=offsetTracking
		subsystem=APS
		component=ICS.FOC.KMirror
	}
	{
		name=positionTiltPlate
		subsystem=APS
		component=ICS.FOC.TiltPlate
	}
	{
		name=positionBeamSplitter
		subsystem=APS
		component=ICS.FOC.SteeringBeamSplitterStage
	}
	{
		name=changeScale
		subsystem=APS
		component=ICS.FOC.CollinmatorUnit
	}
    {
        name=checkRefBeamMap
        subsystem=APS
        component=ICS.Computation
    }
    {
        name=selectFilter
        subsystem=APS
        component=ICS.PIT.FilterWheel
    }
    {
        name=selectPupilMask
        subsystem=APS
        component=ICS.PIT.PupilMaskWheel
    }
    {
        name=configureDetector
        subsystem=APS
        component=ICS.PIT.Detector
    }
    {
		name=abortExposure
		subsystem=APS
		component=ICS.PIT.Detector
	}
	
    # External TCS commands
	{
		name=offsetTelescopePosAptPixels
		subsystem=TCS
		component=TCS APS Assembly
	}
	

	
]
