subsystem=APS
component=ICS.ABE.Enclosure
publish {

events=[
		{
			name=status
			description="""ABE Enclosure status event"""
			maxRate = 1
			archive=true
            category=STATUS
			attributes=[
				{
					name=assemblyState
					description="""Current Assembly State"""
					enum = ["READY", "DEGRADED", "FAULTED"]
				}
				{
					name=hcdState
					description="""Current HCD State of the HCD that the assembly communicates with"""
					enum = ["UNINITIALIZED", "READY", "FAULTED"]
				}
				{
					name=commandState
					description="""Status of last command"""
					enum = ["IDLE", "PROCESSING", "ERROR_RECOVERY", "FAILED"]
				}
				{
					name=purgeAirFlowRate
					description="""Purge Air Flow Rate (liters/sec)"""
					type=float
                    units=NoUnits
				}
				{
					name=coolantPressure
					description="""Overall Coolant Pressure (bars)"""
					type=float
                    units=bar
				}
                

                
                {
                    name=benchCoolantLeakSensorFaultDetection
                    description="""The state of the sensor detecting coolant leaks at the bench"""
                    enum=["READY", "FAULTED"]
                }
                {
                    name=rackToBenchCoolantLeakSensorFaultDetection
                    description="""The state of the sensor detecting coolant leaks between the electronics enclosure and bench"""
                    enum=["READY", "FAULTED"]
                }
                {
                    name=rackCoolantLeakSensorFaultDetection
                    description="""The state of the sensor detecting coolant leaks in the electronics enclosure"""
                    enum=["READY", "FAULTED"]
                }
                {
                    name=benchCoolantLeakSensorDetectionState
                    description="""Coolant leak detection state within the APS Bench"""
                    enum=["NONE", "LEAK_DETECTED"]
                }
                {
                    name=rackToBenchCoolantLeakSensorDetectionState
                    description="""Coolant leak detection state between the APS Electronics Rack and the APS Bench"""
                    enum=["NONE", "LEAK_DETECTED"]
                }
                {
                    name=rackCoolantLeakSensorDetectionState
                    description="""Coolant leak detection state within the APS Electronics Rack"""
                    enum=["NONE", "LEAK_DETECTED"]
                }
                
				{
					name=pshCoolantFlowRate
					description="""PSH Detector Coolant Flow Rate (liters/sec)"""
					type=float
                    units=NoUnits
				}
				{
					name=pitCoolantFlowRate
					description="""PIT Detector Coolant Flow Rate (liters/sec)"""
					type=float
                    units=NoUnits
				}
				{
					name=aptCoolantFlowRate
					description="""APT Detector Coolant Flow Rate (liters/sec)"""
					type=float
                    units=NoUnits
				}
				{
					name=lowfsCoolantFlowRate
					description="""LOWFS Detector Coolant Flow Rate (liters/sec)"""
					type=float
                    units=NoUnits
				}
				{
					name=shutterTemperature
					description="""Current shutter temperature (deg C)"""
					type=float
                    units=degC
				}
				{
					name=shutterHumidity
					description="""Current shutter relative humidity (%)"""
					type=float
                    units=percent
				}
				{
					name=shutterDewPoint
					description="""Current shutter dew point (deg C)"""
					type=float
                    units=degC
				}
				{
					name=pshTemperature
					description="""Current PSH detector temperature (deg C)"""
					type=float
                    units=degC
				}
				{
					name=pshHumidity
					description="""Current PSH detector relative humidity (%)"""
					type=float
                    units=percent
				}
				{
					name=pshDewPoint
					description="""Current PSH detector dew point (deg C)"""
					type=float
                    units=degC
				}
				{
					name=electronicsCabinetTemperature
					description="""Current Electronics Cabinet temperature (deg C)"""
					type=float
                    units=degC
				}
				{
					name=electronicsCabinetHumidity
					description="""Current Electronics Cabinet relative humidity (%)"""
					type=float
                    units=percent
				}
				{
					name=electronicsCabinetDewPoint
					description="""Current Electronics Cabinet dew point (deg C)"""
					type=float
                    units=degC
				}
				{
					name=placeholderCurrentTemperature
					description="""Placeholder for temperature readings from temperature sensors placed at various positions on the bench.  Number of sensors and positions TBD"""
					type=float
                    units=degC
				}

			]
		}
        {
			name=apsAlertEvent
			archive=true
			description="""Event used to communicate that an unexpected condition occured."""
			maxRate = 1
            category=EVENT
			archive=true
			attributes=[
				{
					name=messageSeverity
					description="""Unhandled errors require filling the message field, whereas other types should fill in the messageId"""
					enum = [WARN, ERROR, UNHANDLED_ERROR]
                }
				{
					name=source
					description="""Sensor originating warnings, errors, controller error codes/messages reported from the controller, and warnings/errors that are a result of calculations"""
					enum = [SENSOR, HARDWARE_REPORTED, CALCULATED]
                }
				{
					name=messageId
					description="""Key used within the PEAS UI resource properties configuration file that holds all alert messages.  Different from procedure events, these alert messages contain placeholders for messageArgs in this alert event."""
					type=string
                }
                {
                    name=messageArgs
                    description="""The message text obtained by the message Id key contains argument placeholders (e.g., {0}, {1}, etc.) that indicate where variable argument values will be inserted. This field provides the ordered list of string values to substitute into the message at the corresponding placeholder positions."""
                    type=string
                }
				{
					name=message
					description="""Message supplied by the event source for unhandled errors"""
					type=string
                }
			]
		}
        {
			name=startupMetrics
			description="""assembly startup metrics"""
			maxRate = 1
            category=ARCHIVE
			archive=true
			attributes=[
				{
					name=initStartTime
					description="""Assembly initialization start time"""
					type=taiDate
				}
				{
					name=initCompletedTime
					description="""Assembly initialization completed time"""
					type=taiDate
				}

			]
		}

    ]
    
    alarms = [
        {
            name = hcdNotLocated
            description = """Galil HCD can not be located (HCD is down or location service fault)."""
            severityLevels = [Major]
            location = "Assembly"
            alarmType = System
            probableCause = "Network error or HCD not started"
            operatorResponse = "Restart HCD"
            autoAck = false
            latched = false
        }
        {
            name = hcdFaulted
            description = """Galil HCD is in the faulted state."""
            severityLevels = [Major]
            location = "Assembly"
            alarmType = System
            probableCause = "Network or communication failure with Galil Controller"
            operatorResponse = "Restart Galil Controller and HCD"
            autoAck = false
            latched = false
        }



        {
            name=purgeAirFlowRateLowWarning
            description="""Purge Air Flow Rate below warning limits. """
            severityLevels = [Warning]
            location = "APS Purge Air System"
            alarmType = Absolute
            probableCause = ""
            operatorResponse = "Resend flow rate command.  If unsuccessful, contact support to diagnose/fix during the day."
            autoAck = false
            latched = false
        }
        {
            name=purgeAirFlowRateLowCritical
            description="""Purge Air Flow Rate below critical limits. """
            severityLevels = [Major]
            location = "APS Purge Air System"
            alarmType = Absolute
            probableCause = ""
            operatorResponse = "Resend flow rate command.  If unsuccessful, contact support to diagnose/fix during the day."
            autoAck = false
            latched = false
        }

        {
            name=coolantPressureHighWarning
            description="""Overall Coolant Pressure above warning limits"""
            severityLevels = [Warning]
            location = "TBD..."
            alarmType = Absolute
            probableCause = "Coolant system failure"
            operatorResponse = "Contact on-call support"
            autoAck = false
            latched = false
        }
        
        {
            name=coolantPressureLowWarning
            description="""Overall Coolant Pressure below warning limits"""
            severityLevels = [Warning]
            location = "TBD..."
            alarmType = Absolute
            probableCause = "Coolant system failure"
            operatorResponse = "Contact on-call support"
            autoAck = false
            latched = false
        }

        {
            name=pshCoolantFlowRateWarning
            description="""PSH Detector Coolant Flow Rate below warning limit"""
            severityLevels = [Warning]
            location = "TBD..."
            alarmType = Absolute
            probableCause = "Coolant system failure"
            operatorResponse = "Monitor PSH CCD temperature"
            autoAck = false
            latched = false
        }
        {
            name=pitCoolantFlowRateWarning
            description="""PIT Detector Coolant Flow Rate below warning limit"""
            severityLevels = [Warning]
            location = "APS Bench"
            alarmType = Absolute
            probableCause = "Coolant system failure"
            operatorResponse = "Monitor PIT CCD temperature"
            autoAck = false
            latched = false
        }
        {
            name=aptCoolantFlowRateWarning
            description="""APT Detector Coolant Flow Rate below warning limit"""
            severityLevels = [Warning]
            location = "APS Bench"
            alarmType = Absolute
            probableCause = "Coolant system failure"
            operatorResponse = "Monitor APT CCD temperature"
            autoAck = false
            latched = false
        }
        {
            name=lowfsCoolantFlowRateWarning
            description="""LOWFS Detector Coolant Flow Rate below warning limit"""
            severityLevels = [Warning]
            location = "APS Bench"
            alarmType = Absolute
            probableCause = "Coolant system failure"
            operatorResponse = "Monitor LOWFS CCD temperature"
            autoAck = false
            latched = false
        }
        
        {
            name=shutterDewpointDifferenceWarning
            description="""Current shutter temperature is within warning levels of dew point"""
            severityLevels = [Warning]
            location = "APS Bench"
            alarmType = Calculated
            probableCause = "Environmental conditions"
            operatorResponse = "Monitor carefully for a critical condition "
            autoAck = false
            latched = false
        }
        {
            name=shutterDewpointDifferenceCritical
            description="""Current shutter temperature is at critical levels of dew point"""
            severityLevels = [Critical]
            location = "APS Bench"
            alarmType = Calculated
            probableCause = "Environmental conditions"
            operatorResponse = "APS will start purge air in response to this condition.  1. Verify that this automatic response has occured.  If not, manually command APS  purge air. If unsuccessful, contact support.  2. Close shutter if temperature and dewpoint conditions inside APS do not improve."
            autoAck = false
            latched = false
        }

        {
            name=shutterHumidityWarning
            description="""Current shutter humidity is above warning levels """
            severityLevels = [Warning]
            location = "APS Bench"
            alarmType = Absolute
            probableCause = "Environmental conditions"
            operatorResponse = "Monitor carefully for a critical condition "
            autoAck = false
            latched = false
        }
        {
            name=shutterHumidityCritical
            description="""Current shutter humidity is at or above critical levels"""
            severityLevels = [Critical]
            location = "APS Bench"
            alarmType = Absolute
            probableCause = "Environmental conditions"
            operatorResponse = "APS will start purge air in response to this condition.  1. Verify that this automatic response has occured.  If not, manually command APS  purge air. If unsuccessful, contact support.  2. Close shutter if temperature and dewpoint conditions inside APS do not improve."
            autoAck = false
            latched = false
        }


       {
            name=pshDewpointDifferenceWarning
            description="""Current PSH ambient temperature is within warning levels of dew point"""
            severityLevels = [Warning]
            location = "APS Bench"
            alarmType = Calculated
            probableCause = "Environmental conditions"
            operatorResponse = "Monitor carefully for a critical condition "
            autoAck = false
            latched = false
        }
        {
            name=pshDewpointDifferenceCritical
            description="""Current PSH ambient temperature is at critical levels of dew point"""
            severityLevels = [Critical]
            location = "APS Bench"
            alarmType = Calculated
            probableCause = "Environmental conditions"
            operatorResponse = "APS will start purge air in response to this condition.  1. Verify that this automatic response has occured.  If not, manually command APS  purge air. If unsuccessful, contact support.  2. Close shutter if temperature and dewpoint conditions inside APS do not improve."
            autoAck = false
            latched = false
        }

        {
            name=pshHumidityWarning
            description="""Current PSH ambient humidity is above warning levels """
            severityLevels = [Warning]
            location = "APS Bench"
            alarmType = Absolute
            probableCause = "Environmental conditions"
            operatorResponse = "Monitor carefully for a critical condition "
            autoAck = false
            latched = false
        }
        {
            name=pshHumidityCritical
            description="""Current PSH ambient humidity is at or above critical levels"""
            severityLevels = [Critical]
            location = "APS Bench"
            alarmType = Absolute
            probableCause = "Environmental conditions"
            operatorResponse = "APS will start purge air in response to this condition.  1. Verify that this automatic response has occured.  If not, manually command APS  purge air. If unsuccessful, contact support.  2. Close shutter if temperature and dewpoint conditions inside APS do not improve."
            autoAck = false
            latched = false
        }

        {
            name=electronicsCabinetTemperatureHighWarning
            description="""Current Electronics Cabinet temperature exceeds warning levels"""
            severityLevels = [Warning]
            location = "APS Electronics Cabinet"
            alarmType = System
            probableCause = "Failure of coolant system"
            operatorResponse = "Monitor temperature "
            autoAck = false
            latched = false
        }
        {
            name=electronicsCabinetTemperatureHighCritical
            description="""Current Electronics Cabinet temperature exceeds critical levels"""
            severityLevels = [Critical]
            location = "APS Electronics Cabinet"
            alarmType = System
            probableCause = "Failure of coolant system"
            operatorResponse = "Shut down all electronics in electronics cabinet to protect electronics using the APS Engineering Console."
            autoAck = false
            latched = false
        }
        {
            name=electronicsCabinetHumidityWarning
            description="""Current Electronics Cabinet relative humidity (%)"""
            severityLevels = [Warning]
            location = "APS Electronics Cabinet"
            alarmType = Absolute
            probableCause = "Failure of humidity control"
            operatorResponse = "Monitor electronics cabinet humidity for worsening humidity"
            autoAck = false
            latched = false
        }
        {
            name=electronicsCabinetDewPointWarning
            description="""Current Electronics Cabinet dew point (deg C)"""
            severityLevels = [Warning]
            location = "APS Electronics Cabinet"
            alarmType = Absolute
            probableCause = "Failure of humidity control"
            operatorResponse = "Monitor electronics cabinet humidity for worsening humidity"
            autoAck = false
            latched = false
        }        
        {
            name=BenchLeakSensorFaultWarning
            description="""The bench coolant leak sensor is faulted"""
            severityLevels = [Warning]
            location = "APS Bench"
            alarmType = Absolute
            probableCause = """1. The RJ-11 leader is disconnected from the Flood Sensor box.
2. There’s a severe pinch, twist or other physical damage to the orange-twisted Flood Cable.
3. Power is no longer being supplied to the Flood Sensor box."""
            operatorResponse = "Arrange for technician to diagnose problem during the day"
            autoAck = false
            latched = false
        }
        {
            name=RackToBenchLeakSensorFaultWarning
            description="""The electronics rack to bench coolant leak sensor is faulted"""
            severityLevels = [Warning]
            location = "Between Electronics Enclosure and APS Bench"
            alarmType = Absolute
            probableCause = """1. The RJ-11 leader is disconnected from the Flood Sensor box.
2. There’s a severe pinch, twist or other physical damage to the orange-twisted Flood Cable.
3. Power is no longer being supplied to the Flood Sensor box."""
            operatorResponse = "Arrange for technician to diagnose problem during the day"
            autoAck = false
            latched = false
        }
        {
            name=ElectronicsRackLeakSensorFaultWarning
            description="""The electronics rack coolant leak sensor is faulted"""
            severityLevels = [Warning]
            location = "APS Electronics Enclosure"
            alarmType = Absolute
            probableCause = """1. The RJ-11 leader is disconnected from the Flood Sensor box.
2. There’s a severe pinch, twist or other physical damage to the orange-twisted Flood Cable.
3. Power is no longer being supplied to the Flood Sensor box."""
            operatorResponse = "Arrange for technician to diagnose problem during the day"
            autoAck = false
            latched = false
        }
        {
            name=BenchLeakSensorCritical
            description="""The bench coolant leak sensor has detected a coolant leak"""
            severityLevels = [Critical]
            location = "APS Bench"
            alarmType = Absolute
            probableCause = """A leak has developed in the coolant flow"""
            operatorResponse = "APS will turn off coolant flow valve in response to this condition.  1. Verify that this automatic response has occured.  If not, manually command APS coolant flow valve off. If unsuccessful, contact support immediately.  2. Power down all bench components using the APS Engineering console and power down all electronics cabinet components using the APS Engineering console."
            autoAck = false
            latched = false
        }
        {
            name=RackToBenchLeakSensorCritical
            description="""The electronics rack to bench coolant leak sensor has detected a coolant leak"""
            severityLevels = [Critical]
            location = "Between Electronics Enclosure and APS Bench"
            alarmType = Absolute
            probableCause = """A leak has developed in the coolant flow"""
            operatorResponse = "APS will turn off coolant flow valve in response to this condition.  1. Verify that this automatic response has occured.  If not, manually command APS coolant flow valve off. If unsuccessful, contact support immediately.  2. Power down all bench components using the APS Engineering console and power down all electronics cabinet components using the APS Engineering console."
            autoAck = false
            latched = false
        }
        {
            name=RackLeakSensorCritical
            description="""The electronics rack coolant leak sensor has detected a coolant leak"""
            severityLevels = [Critical]
            location = "Electronics Enclosure"
            alarmType = Absolute
            probableCause = """A leak has developed in the coolant flow"""
            operatorResponse = "APS will turn off coolant flow valve in response to this condition.  1. Verify that this automatic response has occured.  If not, manually command APS coolant flow valve off. If unsuccessful, contact support immediately.  2. Power down all bench components using the APS Engineering console and power down all electronics cabinet components using the APS Engineering console."
            autoAck = false
            latched = false
        }

    ]
}
